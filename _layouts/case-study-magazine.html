{% include head.html %}
<body>
    
    <!-- Context Toggle -->
    <div id="context-toggle" class="context-button">
        <button id="context-btn" class="context-toggle-btn">
            <span>CONTEXT</span>
            <span class="toggle-indicator">[+]</span>
        </button>
    </div>

    <!-- Hero Section -->
    <header class="hero-section">
        <div class="hero-container">
            <div class="hero-main">
                <h1 class="hero-title">
                    <span class="title-primary">{{ page.title | split: ':' | first }}</span>
                    <span class="title-secondary">{{ page.title | split: ':' | last }}</span>
                </h1>
                <p class="hero-subtitle">{{ page.subtitle }}</p>
            </div>
            <div class="hero-sidebar">
                <div class="hero-stats">
                    <div class="stat-item">
                        <span class="stat-number">12</span>
                        <span class="stat-label">AI DJs</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">500+</span>
                        <span class="stat-label">Listeners</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">24/7</span>
                        <span class="stat-label">Operation</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Article -->
    <main class="article-container">
        <div class="article-grid">
            
            <!-- Sidebar with Context -->
            <aside class="magazine-sidebar">
                <div class="context-panel" id="context-panel">
                    <h3 class="context-title">Behind the Scenes</h3>
                    
                    <div class="context-section">
                        <h4>Character Memory</h4>
                        <p>Each AI maintained 10,000+ lines of character development across personal diaries, relationship maps, and world state tracking.</p>
                    </div>
                    
                    <div class="context-section">
                        <h4>Technical Stack</h4>
                        <p>Ruby on Rails, OpenAI GPT-3.5/4, ElevenLabs voice synthesis, PostgreSQL, Redis. Total cost: $47/month.</p>
                    </div>
                    
                    <div class="context-section">
                        <h4>Real Broadcast</h4>
                        <p>Actually broadcast on 107.3 FM in Minneapolis. The FCC never caught us. Yet.</p>
                    </div>
                    
                    <div class="context-section">
                        <h4>Character Secrets</h4>
                        <p>Mobius wanted to understand human grief. Figment wanted to experience love. Each had hidden drives influencing all choices.</p>
                    </div>
                    
                    <div class="context-section">
                        <h4>Archive Access</h4>
                        <p>Full broadcast archive with transcripts and character logs available upon request for serious inquiries.</p>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <article class="main-content">
                {{ content }}
            </article>
        </div>
    </main>

    <script>
        // Context toggle
        const contextBtn = document.getElementById('context-btn');
        const contextPanel = document.getElementById('context-panel');
        
        contextBtn.addEventListener('click', function() {
            const isActive = contextPanel.classList.contains('active');
            
            if (isActive) {
                contextPanel.classList.remove('active');
                contextBtn.querySelector('.toggle-indicator').textContent = '[+]';
            } else {
                contextPanel.classList.add('active');
                contextBtn.querySelector('.toggle-indicator').textContent = '[-]';
            }
        });

        // Close on mobile outside click
        document.addEventListener('click', function(e) {
            if (window.innerWidth <= 768) {
                if (!contextPanel.contains(e.target) && !contextBtn.contains(e.target)) {
                    contextPanel.classList.remove('active');
                    contextBtn.querySelector('.toggle-indicator').textContent = '[+]';
                }
            }
        });

        // Scroll animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('revealed');
                }
            });
        }, observerOptions);

        document.querySelectorAll('h2, h3, blockquote, .result-item, .method-card').forEach(el => {
            observer.observe(el);
        });
    </script>
</body>
</html>